@if (data) {
<div class="wrapper">
    @if (condition) {
    <div class="condition" (click)="condition = undefined">
        {{condition}}
        <!-- <mat-icon (click)="condition = undefined">clear</mat-icon> -->
    </div>
    }
    <header class="header">
        <div class="players">
            @for (item of data.players; track item) {
            <app-player [data]="item" [is_help]="data.is_help ? (data.field.fight?.gold ?? false) : false"></app-player>
            }
        </div>
        <div class="stats">
            <app-player [data]="data.you" [dataMesto]="dataMesto" (close)="closeYou()"
                [can_sbros]="!data.is_fight"></app-player>
        </div>
    </header>
    <main class="main">
        <div class="left pereferia">
            <app-card [class.podsvet]="data.you_hodish && (step == 0 || step == 1)" (click)="getDoorCard()"></app-card>
            <span>Колода</span>
            <app-card [treasure]="true"></app-card>
        </div>
        <div class="center">
            <div class="field">
                @if (data.field.fight && data.field.is_fight) {
                <div class="monsters">
                    <span class="bgcont">
                        Сила стороны: {{data.field.fight.monsterStrongest}}
                        На кону: {{data.field.fight.gold ?? 1}} Сокровищ, {{data.field.fight.lvls}} Уровней
                    </span>
                    <div class="osn">
                        @for (item of data.field.fight.monsters; track item) {
                        <app-card [data]="item"></app-card>
                        }
                    </div>
                </div>
                <div class="players">
                    <div class="osn">
                        <app-player [data]="data.field.fight.players.main.player"></app-player>
                        @if (data.field.fight.players.secondary)
                        {<app-player [data]="data.field.fight.players.secondary.player"></app-player>}
                        <span class="bgcont"> Сила стороны: {{data.field.fight.players.strongest}} </span>
                    </div>
                </div>
                }
                @else {
                <div class="cards gap">
                    @for (item of data.field.openCards; track item) {
                    <app-card class="card" [data]="item"></app-card>
                    }
                </div>
                }
            </div>
            <div class="log">
                @for (item of log_; track item) {
                <div class="bgcont" @height>
                    {{item}}
                </div>
                }
            </div>
        </div>
        <div class="right pereferia">
            <app-card></app-card>
            <span>Сброс</span>
            <app-card [treasure]="true"></app-card>
        </div>
    </main>
    <footer class="footer">
        <div class="menu">
            <button mat-raised-button [disabled]="canEnd()" (click)="endHod()">end</button>
            <button mat-raised-button [disabled]="!data.pas" (click)="setPas()">pas</button>
            <button mat-raised-button [disabled]="!data.smivka" (click)="smivka()">smivka</button>
            <button mat-raised-button [disabled]="!data.help_ask" (click)="openHelpDialog()">help</button>
        </div>
        <div class="cards">
            @for (item of data.you.cards; track item) {
            <app-card class="card" [data]="item" (use_mesto)="useCardMesto($event)" (use_card)="useCard($event)"
                [can_use]="true" [can_sbros]="data.step == 3" (sbros)="sbros($event)"></app-card>
            }
        </div>
    </footer>
</div>
}
@else {
<div class="backdrop">
    <span style="color: white;">Загрузка...</span>
</div>
}